name: Autograding - Katas Grille Flexbox

on:
  push:
    branches: [main, master]

permissions:
  actions: read
  contents: read

jobs:
  autograding:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Grille - accroche (cols_8_de_12)
        id: g1
        uses: classroom-resources/autograding-command-grader@v1
        with:
          test-name: 'Grille - accroche (cols_8_de_12)'
          setup-command: 'npm ci || npm install && npx playwright install chromium --with-deps'
          command: 'node tests/run.js G1'
          timeout: '5'
          max-score: '5'

      - name: Grille - nouvelles (3 articles cols_4_de_12)
        id: g2
        uses: classroom-resources/autograding-command-grader@v1
        with:
          test-name: 'Grille - nouvelles (3 articles cols_4_de_12)'
          setup-command: ''
          command: 'node tests/run.js G2'
          timeout: '5'
          max-score: '5'

      - name: Grille - centre (2 colonnes cols_6_de_12)
        id: g3
        uses: classroom-resources/autograding-command-grader@v1
        with:
          test-name: 'Grille - centre (2 colonnes cols_6_de_12)'
          setup-command: ''
          command: 'node tests/run.js G3'
          timeout: '5'
          max-score: '5'

      - name: Grille - services (cols_4_de_12 et cols_8_de_12)
        id: g4
        uses: classroom-resources/autograding-command-grader@v1
        with:
          test-name: 'Grille - services (cols_4_de_12 et cols_8_de_12)'
          setup-command: ''
          command: 'node tests/run.js G4'
          timeout: '5'
          max-score: '5'

      - name: Autograding Reporter
        if: always()
        uses: classroom-resources/autograding-grading-reporter@v1
        env:
          G1_RESULTS: ${{ steps.g1.outputs.result }}
          G2_RESULTS: ${{ steps.g2.outputs.result }}
          G3_RESULTS: ${{ steps.g3.outputs.result }}
          G4_RESULTS: ${{ steps.g4.outputs.result }}
        with:
          runners: g1,g2,g3,g4
